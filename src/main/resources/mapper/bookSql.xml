<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.bitnc4.mapper.BookMapper">
    <select id="searchroomdto" parameterType="BookDto" resultType="RoomDto">
        select *
        from room
        where hotelnum = #{hotelnum}
          and (num NOT in (select room_num
                           from book
                           where room_num IN (SELECT num FROM room WHERE hotelnum = #{hotelnum}) and
                                 (checkin &lt; #{checkin} and checkout &gt; #{checkout})
                              or (checkin &lt; #{checkin} and checkout
                               &gt; #{checkout})));
    </select>
</mapper>